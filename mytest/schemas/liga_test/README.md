# **Разработчик**

Разработчик
 1. Как удалить полные дубли строк?
 2. Выбрать ФИО клиента + телефон + емейл + адрес
 3. Посчитать сумму транзакций клиента в рублях за месяц
 4. Выбрать все изменения контактных телефонов за месяц

**Модель данных:**

Таблица CUSTOMER - клиенты

| **CUST\_ID** | **FULLNAME** | **SEX** | **BIRTH\_DT** | **VALID\_FROM** | **VALID\_TO** |
| --- | --- | --- | --- | --- | --- |
| 1 | Иванова | Ж | 01.01.1960 | 01.01.1900 | 01.01.2021 |
| 1 | Петрова | Ж | 01.01.1960 | 01.01.2021 | 01.01.4000 |
| 2 | Петров | М | 01.01.1955 | 01.01.1900 | 01.01.4000 |
| 3 | Сидоров | М | 01.01.1980 | 01.01.1900 | 01.01.4000 |
| ... | ... | ... | ... | ... | ... |

Таблица CUSTOMER\_CONTACT - контакты клиентов

| **CUST\_ID** | **TYPE** | **VALUE** | **VALID\_FROM** | **VALID\_TO** |
| --- | --- | --- | --- | --- |
| 1 | EMAIL | ivanova@[mail.ru](http://mail.ru/) | 01.01.1900 | 01.01.4000 |
| 1 | PHONE | +7 965 123 45 67 | 01.01.1900 | 01.01.4000 |
| 1 | ADDRESS | г. Саратов, улица Ленина, дом 8 | 01.01.1900 | 01.01.2021 |
| 1 | ADDRESS | г. Москва, улица Ленина, дом 10 | 01.01.2021 | 01.01.4000 |
| 2 | EMAIL | petrov@mail.ru | 01.01.1900 | 01.01.4000 |
| 2 | ADDRESS | г. Москва, улица Ленина, дом 10 | 01.01.1900 | 01.01.4000 |
| 3 | EMAIL | sidorov@[mail.ru](http://mail.ru/) | 01.01.1900 | 01.01.4000 |
| 3 | PHONE | + 7 965 678 12 34 | 01.01.1900 | 01.01.4000 |
| 3 | ADDRESS | г. Саратов, улица Ленина, дом 9 | 01.01.1900 | 01.01.4000 |
| ... | ... | ... | ... | ... |

Таблица TRANSACTION - транзакции клиентов

| **CUST\_ID** | **TRANSACTION\_DT** | **CURRENCY\_ID** | **TRANSACTION\_AMT** |
| --- | --- | --- | --- |
| 1 | 01.01.2021 | RUR | 1000 |
| 1 | 02.01.2021 | EUR | 100 |
| 1 | 03.01.2021 | EUR | 100 |
| 1 | 04.01.2021 | USD | 50 |
| 2 | 01.01.2021 | USD | 150 |
| 2 | 02.01.2021 | USD | 200 |
| 2 | 04.01.2021 | USD | 50 |
| 3 | 01.01.2021 | RUR | 2000 |
| 3 | 04.01.2021 | RUR | 5000 |
| ... | ... | ... | ... |

Таблица CURRENCY\_RATE - курсы валют

| **CURRENCY\_ID** | **EXCH\_RATE** | **VALID\_FROM** | **VALID\_TO** |
| --- | --- | --- | --- |
| RUR | 1 | 01.01.1900 | 01.01.4000 |
| EUR | 90 | 01.01.2021 | 03.01.2021 |
| EUR | 95 | 03.01.2021 | 01.01.4000 |
| USD | 70 | 01.01.2021 | 02.01.2021 |
| USD | 75 | 02.01.2021 | 04.01.2021 |
| USD | 70 | 04.01.2021 | 01.01.4000 |
| ... | ... | ... | ... |